<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CHAIN FITNESS</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<div class="app">

<!-- TOP BAR -->
<div class="topbar">
  <button id="loginBtn">Login</button>
  <button id="logoutBtn" style="display:none;">Logout</button>
</div>

<!-- LOGIN -->
<div id="loginModal" class="login-overlay">
  <div class="login-box">
    <img src="./logo.jpg" class="login-logo">
    <h2>Admin Login</h2>
    <input id="authPass" type="password" placeholder="Password">
    <button id="authSubmit">Login</button>
    <p id="authError">Wrong password</p>
  </div>
</div>

<header>
  <img src="./logo.jpg" class="hero-logo">
  <h1>CHAIN FITNESS</h1>
  <p class="subtitle">Member Management System</p>
</header>

<div id="protectedArea" style="display:none">

<!-- FORM -->
<div class="card">
<h2>Add / Edit Member</h2>

<form id="memberForm">
<input type="hidden" id="memberId">

<input id="fullName" placeholder="Full Name" required>
<input id="phone" placeholder="Phone">
<input id="email" placeholder="Email">

<select id="membership">
<option>Male Membership</option>
<option>Female Membership</option>
<option>Student Membership</option>
</select>

<input id="joinDate" type="date">
<input id="expiryDate" type="date">
<input id="address" placeholder="Address">

<div class="form-actions">
<button type="submit" id="saveBtn">Save</button>
<button type="button" id="resetBtn" class="ghost">Reset</button>
</div>
</form>
</div>

<!-- TABLE -->
<div class="card">
<input id="search" class="search" placeholder="Search member">

<div class="table-wrap">
<table id="membersTable">
<thead>
<tr>
<th>#</th><th>Name</th><th>Phone</th><th>Expiry</th><th>Actions</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>
</div>

</div>
</div>

<script>
const PASSWORD="chainfitness123";
const loginBtn=loginBtnEl=document.getElementById("loginBtn");
const logoutBtn=document.getElementById("logoutBtn");
const protectedArea=document.getElementById("protectedArea");
const loginModal=document.getElementById("loginModal");

function checkAuth(){
const ok=localStorage.getItem("auth")==="yes";
protectedArea.style.display=ok?"block":"none";
loginBtn.style.display=ok?"none":"inline";
logoutBtn.style.display=ok?"inline":"none";
}
checkAuth();

loginBtn.onclick=()=>loginModal.style.display="flex";
logoutBtn.onclick=()=>{localStorage.removeItem("auth");checkAuth()};

document.getElementById("authSubmit").onclick=()=>{
if(authPass.value===PASSWORD){
localStorage.setItem("auth","yes");
loginModal.style.display="none";
checkAuth(); init();
}else authError.style.display="block";
};

function init(){
const KEY="members";
const load=()=>JSON.parse(localStorage.getItem(KEY)||"[]");
const save=d=>localStorage.setItem(KEY,JSON.stringify(d));

function render(){
const tbody=document.querySelector("tbody");
tbody.innerHTML="";
load().forEach((m,i)=>{
tbody.innerHTML+=`
<tr>
<td>${i+1}</td>
<td>${m.fullName}</td>
<td>${m.phone}</td>
<td>${m.expiryDate}</td>
<td>
<button onclick="edit('${m.id}')">Edit</button>
<button class="danger" onclick="del('${m.id}')">Del</button>
</td>
</tr>`;
});
}

memberForm.onsubmit=e=>{
e.preventDefault();
const m={
id:memberId.value||Date.now(),
fullName:fullName.value,
phone:phone.value,
email:email.value,
membership:membership.value,
joinDate:joinDate.value,
expiryDate:expiryDate.value,
address:address.value
};
const arr=load();
const i=arr.findIndex(x=>x.id==m.id);
i>=0?arr[i]=m:arr.push(m);
save(arr); e.target.reset(); render();
};

window.edit=id=>{
const m=load().find(x=>x.id==id);
Object.keys(m).forEach(k=>window[k]&&(window[k].value=m[k]));
};

window.del=id=>{
if(confirm("Delete member?")){
save(load().filter(x=>x.id!=id)); render();
}
};

render();
}

if(localStorage.getItem("auth")==="yes") init();
</script>

</body>
</html>
